<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ù‚ØµØ© Ø¬Ø¯ÙŠØ¯Ø© | I.TECH</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./css/main.css" />
  <style>
    .form-container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 600;
      color: #2c3e50;
    }
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 14px;
      font-family: 'Cairo', sans-serif;
    }
    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }
    }
    .btn-submit {
      background: #27ae60;
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      width: 100%;
      margin-top: 20px;
    }
    .btn-submit:hover {
      background: #219a52;
    }
    .btn-submit:disabled {
      background: #95a5a6;
      cursor: not-allowed;
    }
    .status-message {
      padding: 15px;
      border-radius: 6px;
      margin: 20px 0;
      text-align: center;
      font-weight: 600;
      display: none;
    }
    .status-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .status-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .status-info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    .github-settings {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      margin-bottom: 30px;
    }
    .github-settings h3 {
      margin-top: 0;
      color: #2c3e50;
    }
    .toggle-settings {
      background: #3498db;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin-bottom: 15px;
    }
    .settings-content {
      display: none;
    }
    .settings-content.active {
      display: block;
    }
    .test-connection {
      background: #f39c12;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin-top: 10px;
    }
    .preview-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 6px;
      margin-top: 30px;
    }
    .tender-preview {
      background: white;
      padding: 20px;
      border-radius: 6px;
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <header class="nav">
    <div class="brand">
      <div class="logo-circle">
        <img src="./assets/images/I-Tech logo.png" alt="Ø´Ø¹Ø§Ø± Ø§ÙŠØªÙƒ I.TECH" />
      </div>
      <div class="names">
        <div class="ar">Ø§ÙŠØªÙƒ</div>
        <div class="en">I.TECH</div>
      </div>
    </div>
    <nav class="menu">
      <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="tenders-new.html">Ù…Ù†Ø§Ù‚ØµØ§Øª Ø§Ù„Ø¹Ø±Ø§Ù‚</a>
      <a href="add-tender.html" class="active">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ù‚ØµØ©</a>
      <a href="about.html">Ù…Ù† Ù†Ø­Ù†</a>
      <a href="contact.html">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
    </nav>
    <button class="burger" aria-label="ÙØªØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©">â˜°</button>
  </header>

  <main class="container">
    <div class="form-container">
      <h1>Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ù‚ØµØ© Ø¬Ø¯ÙŠØ¯Ø©</h1>
      <p>Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø§Ù‚ØµØ© Ø¬Ø¯ÙŠØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>

      <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª GitHub -->
      <div class="github-settings">
        <button class="toggle-settings" onclick="toggleGitHubSettings()">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ GitHub</button>
        <div id="githubSettingsContent" class="settings-content">
          <h3>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª GitHub Ù„Ù„Ù†Ø´Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h3>
          <p>Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø·Ù„ÙˆØ¨Ø© Ù„Ù„Ù†Ø´Ø± Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>
          
          <div class="form-row">
            <div class="form-group">
              <label>GitHub Owner</label>
              <input type="text" id="githubOwner" placeholder="abubesun-hub" value="abubesun-hub">
            </div>
            <div class="form-group">
              <label>GitHub Repository</label>
              <input type="text" id="githubRepo" placeholder="I.tech" value="I.tech">
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Branch</label>
              <input type="text" id="githubBranch" placeholder="main" value="main">
            </div>
            <div class="form-group">
              <label>Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</label>
              <input type="text" id="githubPath" placeholder="assets/data/tenders.json" value="assets/data/tenders.json">
            </div>
          </div>
          
          <div class="form-group">
            <label>GitHub Token (Personal Access Token)</label>
            <input type="password" id="githubToken" placeholder="ghp_xxxxxxxxxxxx">
            <small style="color: #7f8c8d;">ÙŠØ­ØªØ§Ø¬ ØµÙ„Ø§Ø­ÙŠØ© contents:write Ù„Ù„Ù…Ø³ØªÙˆØ¯Ø¹</small>
          </div>
          
          <div>
            <label>
              <input type="checkbox" id="saveSettings"> Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø­Ù„ÙŠØ§Ù‹
            </label>
          </div>
          
          <div style="margin: 15px 0; padding: 10px; background: #f8f9fa; border-radius: 4px;">
            <strong>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª:</strong>
            <div style="display: flex; gap: 15px; margin-top: 8px; flex-wrap: wrap;">
              <button type="button" onclick="getCounterStats()" class="btn-edit" style="font-size: 11px; padding: 4px 8px;">ğŸ“Š Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
              <button type="button" onclick="resetCounters()" class="btn-delete" style="font-size: 11px; padding: 4px 8px;">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
            </div>
            <small style="color: #7f8c8d; display: block; margin-top: 5px;">
              Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª: Ø­ÙƒÙˆÙ…ÙŠØ© (GOV-TN)ØŒ Ø´Ø±ÙƒØ§Øª (CMP-TN)ØŒ Ø¬Ø§Ù…Ø¹Ø§Øª (UNI-TN)ØŒ Ù…Ù†Ø¸Ù…Ø§Øª (NGO-TN)
            </small>
          </div>
          
          <button class="test-connection" onclick="testConnection()">Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„</button>
        </div>
      </div>

      <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© -->
      <form id="tenderForm">
        <div class="form-row">
          <div class="form-group">
            <label for="tenderId">Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© *</label>
            <input type="text" id="tenderId" required placeholder="2025-001">
          </div>
          <div class="form-group">
            <label for="tenderStatus">Ø§Ù„Ø­Ø§Ù„Ø©</label>
            <select id="tenderStatus">
              <option value="Ù…ÙØªÙˆØ­">Ù…ÙØªÙˆØ­</option>
              <option value="Ù…ØºÙ„Ù‚">Ù…ØºÙ„Ù‚</option>
              <option value="Ù…Ù†ØªÙ‡ÙŠ">Ù…Ù†ØªÙ‡ÙŠ</option>
              <option value="Ù…Ù„ØºÙŠ">Ù…Ù„ØºÙŠ</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="tenderTitle">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© *</label>
          <input type="text" id="tenderTitle" required placeholder="ØªÙˆØ±ÙŠØ¯ Ù…Ø¹Ø¯Ø§Øª Ø­Ø§Ø³ÙˆØ¨">
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tenderEntity">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø¹Ù„Ù†Ø© *</label>
            <input type="text" id="tenderEntity" required placeholder="ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø¹Ø§Ù„ÙŠ">
          </div>
          <div class="form-group">
            <label for="tenderCategory">Ø§Ù„ØªØµÙ†ÙŠÙ</label>
            <select id="tenderCategory">
              <option value="Ø­ÙƒÙˆÙ…ÙŠØ©">Ø­ÙƒÙˆÙ…ÙŠØ©</option>
              <option value="Ø´Ø±ÙƒØ§Øª">Ø´Ø±ÙƒØ§Øª</option>
              <option value="Ø¬Ø§Ù…Ø¹Ø§Øª">Ø¬Ø§Ù…Ø¹Ø§Øª</option>
              <option value="Ù…Ù†Ø¸Ù…Ø§Øª">Ù…Ù†Ø¸Ù…Ø§Øª</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tenderCity">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</label>
            <input type="text" id="tenderCity" placeholder="Ø¨ØºØ¯Ø§Ø¯">
          </div>
          <div class="form-group">
            <label for="tenderAdNumber">Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† <span style="color: #27ae60; font-size: 12px;">(ØªÙ„Ù‚Ø§Ø¦ÙŠ)</span></label>
            <input type="text" id="tenderAdNumber" readonly placeholder="Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹" style="background-color: #f8f9fa; cursor: not-allowed;">
            <small style="color: #7f8c8d; font-size: 11px;">ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</small>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tenderPostedDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø´Ø±</label>
            <input type="date" id="tenderPostedDate">
          </div>
          <div class="form-group">
            <label for="tenderDeadline">Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ *</label>
            <input type="date" id="tenderDeadline" required>
          </div>
        </div>

        <div class="form-group">
          <label for="tenderDescription">ÙˆØµÙ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©</label>
          <textarea id="tenderDescription" placeholder="ÙˆØµÙ ØªÙØµÙŠÙ„ÙŠ Ù„Ù„Ù…Ù†Ø§Ù‚ØµØ© ÙˆÙ…ØªØ·Ù„Ø¨Ø§ØªÙ‡Ø§"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tenderDocPrice">Ø³Ø¹Ø± Ø§Ù„ÙƒØ±Ø§Ø³</label>
            <input type="number" id="tenderDocPrice" placeholder="25000">
          </div>
          <div class="form-group">
            <label for="tenderCurrency">Ø§Ù„Ø¹Ù…Ù„Ø©</label>
            <select id="tenderCurrency">
              <option value="IQD">Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ (IQD)</option>
              <option value="USD">Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ (USD)</option>
              <option value="EUR">ÙŠÙˆØ±Ùˆ (EUR)</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="tenderPickupLocation">Ù…ÙƒØ§Ù† Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„ÙƒØ±Ø§Ø³</label>
          <input type="text" id="tenderPickupLocation" placeholder="Ù…ÙƒØªØ¨ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª - Ø§Ù„Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø£ÙˆÙ„">
        </div>

        <div class="form-group">
          <label for="tenderSubmissionPlace">Ù…ÙƒØ§Ù† ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¹Ø±ÙˆØ¶</label>
          <input type="text" id="tenderSubmissionPlace" placeholder="ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¹Ø±ÙˆØ¶ - Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù…Ø§Øª">
        </div>

        <div class="form-group">
          <label for="tenderRequirements">Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… (Ù…Ù†ÙØµÙ„Ø© Ø¨ÙØ§ØµÙ„Ø© Ù…Ù†Ù‚ÙˆØ·Ø©)</label>
          <textarea id="tenderRequirements" placeholder="Ù‡ÙˆÙŠØ© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©; ÙƒØªØ§Ø¨ Ø¹Ø¯Ù… Ù…Ù…Ø§Ù†Ø¹Ø©; Ø³Ø¬Ù„ ØªØ¬Ø§Ø±ÙŠ Ø³Ø§Ø±ÙŠ"></textarea>
        </div>

        <div class="form-group">
          <label for="tenderNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
          <textarea id="tenderNotes" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ùˆ Ø´Ø±ÙˆØ· Ø¥Ø¶Ø§ÙÙŠØ©"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="tenderPhone">Ù‡Ø§ØªÙ Ø§Ù„ØªÙˆØ§ØµÙ„</label>
            <input type="tel" id="tenderPhone" placeholder="+964-770-0000000">
          </div>
          <div class="form-group">
            <label for="tenderEmail">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input type="email" id="tenderEmail" placeholder="info@ministry.gov.iq">
          </div>
        </div>

        <div class="form-group">
          <label for="tenderLink">Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø£ØµÙ„ÙŠ</label>
          <input type="url" id="tenderLink" placeholder="https://example.com/tender-details">
        </div>

        <button type="submit" class="btn-submit" id="submitBtn">
          ğŸ“¤ Ù†Ø´Ø± Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹
        </button>
      </form>

      <div id="statusMessage" class="status-message"></div>

      <!-- Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© -->
      <div class="preview-section">
        <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©</h3>
        <div id="tenderPreview" class="tender-preview">
          <p style="color: #7f8c8d; text-align: center;">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©</p>
        </div>
      </div>

      <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù†Ø© -->
      <div class="tenders-table-section">
        <div class="table-header">
          <h3>Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª Ø§Ù„Ù…Ø¹Ù„Ù†Ø©</h3>
          <button onclick="loadTendersTable()" class="btn-refresh">ğŸ”„ ØªØ­Ø¯ÙŠØ«</button>
        </div>
        <div id="tendersTableContainer">
          <div class="empty-state">ğŸ“Š Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª...</div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
    function loadSavedSettings() {
      try {
        const settings = JSON.parse(localStorage.getItem('github_settings') || '{}');
        if (settings.owner) document.getElementById('githubOwner').value = settings.owner;
        if (settings.repo) document.getElementById('githubRepo').value = settings.repo;
        if (settings.branch) document.getElementById('githubBranch').value = settings.branch;
        if (settings.path) document.getElementById('githubPath').value = settings.path;
        if (settings.token) {
          document.getElementById('githubToken').value = settings.token;
          document.getElementById('saveSettings').checked = true;
        }
      } catch (e) {
        console.log('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©');
      }
    }

    // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    function saveSettings() {
      if (document.getElementById('saveSettings').checked) {
        const settings = {
          owner: document.getElementById('githubOwner').value,
          repo: document.getElementById('githubRepo').value,
          branch: document.getElementById('githubBranch').value,
          path: document.getElementById('githubPath').value,
          token: document.getElementById('githubToken').value
        };
        localStorage.setItem('github_settings', JSON.stringify(settings));
      }
    }

    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª GitHub
    function toggleGitHubSettings() {
      const content = document.getElementById('githubSettingsContent');
      content.classList.toggle('active');
    }

    // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ GitHub
    async function testConnection() {
      const owner = document.getElementById('githubOwner').value;
      const repo = document.getElementById('githubRepo').value;
      const token = document.getElementById('githubToken').value;

      if (!owner || !repo || !token) {
        showStatus('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
        return;
      }

      try {
        showStatus('Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„...', 'info');
        
        const response = await fetch(`https://api.github.com/repos/${owner}/${repo}`, {
          headers: {
            'Authorization': `Bearer ${token}`,
            'Accept': 'application/vnd.github+json'
          }
        });

        if (response.ok) {
          showStatus('âœ… Ø§Ù„Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù†Ø´Ø± Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª', 'success');
        } else if (response.status === 401) {
          showStatus('âŒ Token ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©', 'error');
        } else if (response.status === 404) {
          showStatus('âŒ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡', 'error');
        } else {
          showStatus(`âŒ Ø®Ø·Ø£: ${response.status}`, 'error');
        }
      } catch (error) {
        showStatus('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ' + error.message, 'error');
      }
    }

    // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©
    function createTenderObject() {
      const requirements = document.getElementById('tenderRequirements').value
        .split(';')
        .map(r => r.trim())
        .filter(r => r.length > 0);

      return {
        id: document.getElementById('tenderId').value,
        title: document.getElementById('tenderTitle').value,
        entity: document.getElementById('tenderEntity').value,
        category: document.getElementById('tenderCategory').value,
        city: document.getElementById('tenderCity').value,
        adNumber: document.getElementById('tenderAdNumber').value,
        deadline: document.getElementById('tenderDeadline').value,
        postedDate: document.getElementById('tenderPostedDate').value || new Date().toISOString().split('T')[0],
        status: document.getElementById('tenderStatus').value,
        link: document.getElementById('tenderLink').value || '#',
        description: document.getElementById('tenderDescription').value,
        documentPrice: parseInt(document.getElementById('tenderDocPrice').value) || 0,
        currency: document.getElementById('tenderCurrency').value,
        pickupLocation: document.getElementById('tenderPickupLocation').value,
        submissionPlace: document.getElementById('tenderSubmissionPlace').value,
        submissionRequirements: requirements,
        notes: document.getElementById('tenderNotes').value,
        files: [],
        contact: {
          phone: document.getElementById('tenderPhone').value,
          email: document.getElementById('tenderEmail').value
        }
      };
    }

    // Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©
    function updatePreview() {
      const tender = createTenderObject();
      const preview = document.getElementById('tenderPreview');
      
      if (!tender.title && !tender.entity) {
        preview.innerHTML = '<p style="color: #7f8c8d; text-align: center;">Ø§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©</p>';
        return;
      }

      const formatDate = (dateStr) => {
        if (!dateStr) return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        return new Date(dateStr).toLocaleDateString('ar-IQ');
      };

      preview.innerHTML = `
        <h4 style="color: #2c3e50; margin-bottom: 15px;">${tender.title || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}</h4>
        <div style="margin-bottom: 10px;">
          <strong>Ø§Ù„Ø¬Ù‡Ø©:</strong> ${tender.entity || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'} | 
          <strong>Ø§Ù„ØªØµÙ†ÙŠÙ:</strong> ${tender.category} | 
          <strong>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> ${tender.city || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
        </div>
        ${tender.deadline ? `<div style="margin-bottom: 10px;"><strong>Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</strong> ${formatDate(tender.deadline)}</div>` : ''}
        ${tender.adNumber ? `<div style="margin-bottom: 10px;"><strong>Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:</strong> ${tender.adNumber}</div>` : ''}
        ${tender.description ? `<div style="margin-bottom: 15px; color: #34495e;">${tender.description}</div>` : ''}
      `;
    }

    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„Ø©
    function showStatus(message, type) {
      const statusDiv = document.getElementById('statusMessage');
      statusDiv.textContent = message;
      statusDiv.className = `status-message status-${type}`;
      statusDiv.style.display = 'block';
      
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ Ù„Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©
      if (type === 'success' || type === 'info') {
        setTimeout(() => {
          statusDiv.style.display = 'none';
        }, 5000);
      }
    }

    // Ù†Ø´Ø± Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© Ø¹Ù„Ù‰ GitHub
    async function publishToGitHub(tender) {
      const owner = document.getElementById('githubOwner').value;
      const repo = document.getElementById('githubRepo').value;
      const branch = document.getElementById('githubBranch').value;
      const path = document.getElementById('githubPath').value;
      const token = document.getElementById('githubToken').value;

      showStatus('Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©...', 'info');
      
      // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      let currentData = [];
      try {
        const rawUrl = `https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${path}`;
        const response = await fetch(rawUrl);
        if (response.ok) {
          currentData = await response.json();
        }
      } catch (e) {
        console.log('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø³Ø§Ø¨Ù‚Ø©');
      }

      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù…
      const existingIndex = currentData.findIndex(t => t.id === tender.id);
      if (existingIndex >= 0) {
        if (!confirm('ÙŠÙˆØ¬Ø¯ Ù…Ù†Ø§Ù‚ØµØ© Ø¨Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù…. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ØŸ')) {
          throw new Error('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©');
        }
        currentData[existingIndex] = tender;
      } else {
        currentData.push(tender);
      }

      showStatus('Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©...', 'info');

      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ SHA Ù„Ù„Ù…Ù„Ù Ø§Ù„Ø­Ø§Ù„ÙŠ
      let sha = null;
      try {
        const fileResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
          headers: {
            'Authorization': `Bearer ${token}`,
            'Accept': 'application/vnd.github+json'
          }
        });
        if (fileResponse.ok) {
          const fileData = await fileResponse.json();
          sha = fileData.sha;
        }
      } catch (e) {
        console.log('Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯ Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡');
      }

      // Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø­Ø¯Ø«
      const newContent = JSON.stringify(currentData, null, 2);
      const base64Content = btoa(unescape(encodeURIComponent(newContent)));

      const updateData = {
        message: `Add tender: ${tender.id}`,
        content: base64Content,
        branch: branch
      };

      if (sha) {
        updateData.sha = sha;
      }

      const updateResponse = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
        method: 'PUT',
        headers: {
          'Authorization': `Bearer ${token}`,
          'Accept': 'application/vnd.github+json',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(updateData)
      });

      if (!updateResponse.ok) {
        const errorText = await updateResponse.text();
        throw new Error(`GitHub API Error: ${updateResponse.status} - ${errorText}`);
      }

      return await updateResponse.json();
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
    document.getElementById('tenderForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      const originalText = submitBtn.textContent;
      
      try {
        submitBtn.disabled = true;
        submitBtn.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù†Ø´Ø±...';
        
        const tender = createTenderObject();
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        if (!tender.id || !tender.title || !tender.entity || !tender.deadline) {
          throw new Error('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (*)');
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        saveSettings();
        
        // Ù†Ø´Ø± Ø¹Ù„Ù‰ GitHub
        await publishToGitHub(tender);
        
        showStatus('ğŸ‰ ØªÙ… Ù†Ø´Ø± Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© Ø¨Ù†Ø¬Ø§Ø­! Ø³ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø®Ù„Ø§Ù„ Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ù„ÙŠÙ„Ø©.', 'success');
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        document.getElementById('tenderForm').reset();
        updatePreview();
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
        document.getElementById('tenderPostedDate').value = new Date().toISOString().split('T')[0];
        
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù†Ø´Ø±:', error);
        showStatus('âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù†Ø´Ø±: ' + error.message, 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      }
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    document.querySelectorAll('input, select, textarea').forEach(element => {
      element.addEventListener('input', updatePreview);
      element.addEventListener('change', updatePreview);
    });

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
    const burger = document.querySelector('.burger');
    const menu = document.querySelector('.menu');
    if (burger && menu) {
      burger.addEventListener('click', () => {
        menu.classList.toggle('open');
      });
    }

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', () => {
      loadSavedSettings();
      
      // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ ÙƒØ§ÙØªØ±Ø§Ø¶ÙŠ Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø´Ø±
      document.getElementById('tenderPostedDate').value = new Date().toISOString().split('T')[0];
      
      updatePreview();
      
      // ØªØ­Ù…ÙŠÙ„ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª
      loadTendersTable();
      
      // Ø±Ø¨Ø· ØªØºÙŠÙŠØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø¨ØªÙˆÙ„ÙŠØ¯ Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
      document.getElementById('tenderCategory').addEventListener('change', generateAdNumber);
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù‚Ù… Ø¥Ø¹Ù„Ø§Ù† Ø§ÙØªØ±Ø§Ø¶ÙŠ
      generateAdNumber();
    });

    // === Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ±Ù‚ÙŠÙ… Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ===
    
    // Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ±Ù‚ÙŠÙ… Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ø¬Ù‡Ø©
    const numberingPatterns = {
      'Ø­ÙƒÙˆÙ…ÙŠØ©': { prefix: 'GOV-TN', key: 'gov_counter' },
      'Ø´Ø±ÙƒØ§Øª': { prefix: 'CMP-TN', key: 'company_counter' },
      'Ø¬Ø§Ù…Ø¹Ø§Øª': { prefix: 'UNI-TN', key: 'university_counter' },
      'Ù…Ù†Ø¸Ù…Ø§Øª': { prefix: 'NGO-TN', key: 'ngo_counter' }
    };
    
    // ØªÙˆÙ„ÙŠØ¯ Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
    function generateAdNumber() {
      const category = document.getElementById('tenderCategory').value;
      const pattern = numberingPatterns[category];
      
      if (!pattern) {
        document.getElementById('tenderAdNumber').value = 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        return;
      }
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø£Ùˆ Ø§Ù„Ø¨Ø¯Ø¡ Ù…Ù† 1
      let counter = parseInt(localStorage.getItem(pattern.key) || '0') + 1;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙÙŠ localStorage
      localStorage.setItem(pattern.key, counter.toString());
      
      // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù…: PREFIX-YEAR-NUMBER
      const currentYear = new Date().getFullYear();
      const formattedNumber = counter.toString().padStart(3, '0');
      const adNumber = `${pattern.prefix}-${currentYear}-${formattedNumber}`;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ù‚Ù„
      document.getElementById('tenderAdNumber').value = adNumber;
      
      console.log(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù‚Ù… Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯: ${adNumber} Ù„Ù„ÙØ¦Ø©: ${category}`);
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
      updatePreview();
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ (ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ø­Ø°Ù)
    function revertCounter(category) {
      const pattern = numberingPatterns[category];
      if (!pattern) return;
      
      let counter = parseInt(localStorage.getItem(pattern.key) || '1');
      if (counter > 1) {
        counter--;
        localStorage.setItem(pattern.key, counter.toString());
        console.log(`ØªÙ… ØªÙ‚Ù„ÙŠÙ„ Ø¹Ø¯Ø§Ø¯ ${category} Ø¥Ù„Ù‰: ${counter}`);
      }
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª (Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ† ÙÙ‚Ø·)
    function resetCounters() {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
        Object.values(numberingPatterns).forEach(pattern => {
          localStorage.removeItem(pattern.key);
        });
        console.log('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª');
        generateAdNumber(); // Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ù‚Ù…
      }
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª
    function getCounterStats() {
      const stats = {};
      Object.entries(numberingPatterns).forEach(([category, pattern]) => {
        stats[category] = parseInt(localStorage.getItem(pattern.key) || '0');
      });
      console.table(stats);
      return stats;
    }

    // === ÙˆØ¸Ø§Ø¦Ù Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª ===
    
    // ØªØ­Ù…ÙŠÙ„ ÙˆØ¹Ø±Ø¶ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª
    async function loadTendersTable() {
      const container = document.getElementById('tendersTableContainer');
      container.innerHTML = '<div class="empty-state">ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª...</div>';
      
      try {
        // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ù† Ù…Ù„Ù JSON
        const response = await fetch('./assets/data/tenders.json?v=' + Date.now());
        
        if (!response.ok) {
          throw new Error(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„: ${response.status}`);
        }
        
        const tenders = await response.json();
        
        if (!Array.isArray(tenders) || tenders.length === 0) {
          container.innerHTML = '<div class="empty-state">ğŸ“ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø§Ù‚ØµØ§Øª Ù…Ø¹Ù„Ù†Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</div>';
          return;
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        container.innerHTML = `
          <table class="tenders-table">
            <thead>
              <tr>
                <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                <th>Ø§Ù„Ø¬Ù‡Ø©</th>
                <th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th>
                <th>Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th>
                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
              </tr>
            </thead>
            <tbody>
              ${tenders.map(tender => createTenderRow(tender)).join('')}
            </tbody>
          </table>
        `;
        
        console.log(`ØªÙ… ØªØ­Ù…ÙŠÙ„ ${tenders.length} Ù…Ù†Ø§Ù‚ØµØ© ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„`);
        
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ§Øª:', error);
        container.innerHTML = `
          <div class="empty-state">
            âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ${error.message}
            <br><button onclick="loadTendersTable()" class="btn-refresh" style="margin-top: 10px;">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
          </div>
        `;
      }
    }
    
    // Ø¥Ù†Ø´Ø§Ø¡ ØµÙ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù„Ù„Ù…Ù†Ø§Ù‚ØµØ©
    function createTenderRow(tender) {
      const formatDate = (dateStr) => {
        if (!dateStr) return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        try {
          return new Date(dateStr).toLocaleDateString('ar-IQ');
        } catch {
          return dateStr;
        }
      };
      
      const getStatus = (tender) => {
        if (!tender.deadline) return 'â“ ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        
        const deadline = new Date(tender.deadline);
        const now = new Date();
        
        if (deadline < now) return 'âŒ Ù…Ù†ØªÙ‡ÙŠØ©';
        
        const daysLeft = Math.ceil((deadline - now) / (1000 * 60 * 60 * 24));
        if (daysLeft <= 3) return `âš ï¸ ${daysLeft} Ø£ÙŠØ§Ù…`;
        
        return 'âœ… Ù†Ø´Ø·Ø©';
      };
      
      return `
        <tr>
          <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis;" title="${tender.title || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}">
            ${(tender.title || 'Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†').substring(0, 50)}${tender.title && tender.title.length > 50 ? '...' : ''}
          </td>
          <td>${tender.entity || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
          <td>${tender.city || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
          <td>${formatDate(tender.deadline)}</td>
          <td>${getStatus(tender)}</td>
          <td>
            <div class="action-buttons">
              <button onclick="editTender('${tender.id}')" class="btn-edit" title="ØªØ¹Ø¯ÙŠÙ„">âœï¸</button>
              <button onclick="deleteTender('${tender.id}')" class="btn-delete" title="Ø­Ø°Ù">ğŸ—‘ï¸</button>
            </div>
          </td>
        </tr>
      `;
    }
    
    // ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†Ø§Ù‚ØµØ©
    function editTender(tenderId) {
      if (!tenderId) {
        showStatus('âŒ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
        return;
      }
      
      // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© ÙÙŠ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      loadTenderForEdit(tenderId);
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ù…Ù†Ø§Ù‚ØµØ© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„
    async function loadTenderForEdit(tenderId) {
      try {
        const response = await fetch('./assets/data/tenders.json?v=' + Date.now());
        const tenders = await response.json();
        
        const tender = tenders.find(t => t.id === tenderId);
        if (!tender) {
          showStatus('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©', 'error');
          return;
        }
        
        // Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©
        document.getElementById('tenderId').value = tender.id || '';
        document.getElementById('tenderTitle').value = tender.title || '';
        document.getElementById('tenderEntity').value = tender.entity || '';
        document.getElementById('tenderCategory').value = tender.category || '';
        document.getElementById('tenderCity').value = tender.city || '';
        // Ø±Ù‚Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ÙŠÙÙ…Ù„Ø£ Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© (Ù„Ø§ Ù†ØºÙŠØ±Ù‡ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„)
        document.getElementById('tenderAdNumber').value = tender.adNumber || '';
        document.getElementById('tenderDeadline').value = tender.deadline || '';
        document.getElementById('tenderPostedDate').value = tender.postedDate || tender.publishDate || '';
        document.getElementById('tenderStatus').value = tender.status || 'Ù†Ø´Ø·';
        document.getElementById('tenderLink').value = tender.link || '';
        document.getElementById('tenderDescription').value = tender.description || '';
        document.getElementById('tenderDocPrice').value = tender.documentPrice || '';
        document.getElementById('tenderCurrency').value = tender.currency || 'IQD';
        document.getElementById('tenderPickupLocation').value = tender.pickupLocation || '';
        document.getElementById('tenderSubmissionPlace').value = tender.submissionPlace || '';
        document.getElementById('tenderRequirements').value = (tender.submissionRequirements || []).join('; ');
        document.getElementById('tenderNotes').value = tender.notes || '';
        document.getElementById('tenderPhone').value = tender.contact?.phone || '';
        document.getElementById('tenderEmail').value = tender.contact?.email || '';
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©
        updatePreview();
        
        // Ø§Ù„ØªÙ…Ø±ÙŠØ± Ø¥Ù„Ù‰ Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        document.getElementById('tenderForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
        
        showStatus('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„', 'success');
        
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©:', error);
        showStatus('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©: ' + error.message, 'error');
      }
    }
    
    // Ø­Ø°Ù Ù…Ù†Ø§Ù‚ØµØ©
    async function deleteTender(tenderId) {
      if (!tenderId) {
        showStatus('âŒ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
        return;
      }
      
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) {
        return;
      }
      
      try {
        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        const response = await fetch('./assets/data/tenders.json?v=' + Date.now());
        let tenders = await response.json();
        
        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©
        const tenderIndex = tenders.findIndex(t => t.id === tenderId);
        if (tenderIndex === -1) {
          showStatus('âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©', 'error');
          return;
        }
        
        // Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© Ù…Ù† Ø§Ù„Ù…ØµÙÙˆÙØ©
        const deletedTender = tenders[tenderIndex];
        tenders.splice(tenderIndex, 1);
        
        // ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ù„Ù„ÙØ¦Ø© Ø§Ù„Ù…Ø­Ø°ÙˆÙØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
        if (deletedTender.category && numberingPatterns[deletedTender.category]) {
          // ÙŠÙ…ÙƒÙ† Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø·Ø± Ø§Ù„ØªØ§Ù„ÙŠ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø°Ù
          // revertCounter(deletedTender.category);
        }
        
        // Ù‡Ù†Ø§ ÙŠØ¬Ø¨ Ø¥Ø¶Ø§ÙØ© Ø¢Ù„ÙŠØ© Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
        // (ÙŠØªØ·Ù„Ø¨ ØªÙƒØ§Ù…Ù„ Ù…Ø¹ GitHub API Ø£Ùˆ Ø®Ø¯Ù…Ø© Ø£Ø®Ø±Ù‰)
        
        // ØªÙ†Ø¨ÙŠÙ‡: Ø§Ù„Ø­Ø°Ù ÙŠØ¹Ù…Ù„ Ù…Ø¤Ù‚ØªØ§Ù‹ ÙÙ‚Ø· ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
        console.warn('ØªÙ†Ø¨ÙŠÙ‡: Ø§Ù„Ø­Ø°Ù Ù…Ø¤Ù‚Øª ÙÙ‚Ø· - Ù„Ù† ÙŠØªÙ… Ø­ÙØ¸Ù‡ ÙÙŠ Ø§Ù„Ù…Ù„Ù');
        
        showStatus(`âš ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ© "${deletedTender.title}" Ù…Ø¤Ù‚ØªØ§Ù‹ ÙÙ‚Ø·. Ù„Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ± Ø§ØªØµÙ„ Ø¨Ù…Ø§ Ù„Ùƒ Ø§Ù„Ù†Ø¸Ø§Ù…`, 'info');
        
        // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        loadTendersTable();
        
      } catch (error) {
        console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©:', error);
        showStatus('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†Ø§Ù‚ØµØ©: ' + error.message, 'error');
      }
    }
  </script>
</body>
</html>